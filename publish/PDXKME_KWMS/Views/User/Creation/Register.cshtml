@{
    
    ViewBag.Title ="Register";    
    Layout = "~/Views/Shared/_NewLayOut.cshtml";   
}
 <script src="@Url.Content("~/Scripts/ModalHelper/ModalHelper.js")" type="text/javascript"></script> 
 <div class="modal fade" id="MessageModal" role="dialog" style="padding-top: 169px;">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        &times;</button>
                    <h4 class="modal-title">
                   Register</h4>
                </div>
                <div class="modal-body" id="modalBody">
                <img  class="imgError"/>
                <label id="lblMessageText"  class="lblError"></label>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

 <style>

 .flex-active-slide{  width: 85% !important; }  
 .esContainer{  height: 50px !important; } 
 .flex-direction-nav { display:none !important;     } 
 .validationCSS{border-color:#ff8080 !important;box-shadow: 0px 0px 5px 0px #ff8080;display: inline}
 </style>


 <div class="container childcontent"> 
  <div class="panel panelLogin panel-default">
  <div class="panel-heading" style="background-color: #FAC902">
    <h2 class="panel-title">Register</h2>
  </div>
     
  <div class="panel-body">

  <div class="row  ">

  @* For Login To Display *@
    
  <div class="col-lg-4 col-md-8 col-sm-11 col-xs-11 middleMargin " style="padding: 0px 0px 0px 61px ! important;">

  <div class="form-group"  >
    <label> @Resources.Resource.lblUserId:</label>
  <input type="text" id="txtUserID" class="form-control validationcontrols"     style=" width:90% !important; display:inline   " required="required"/>
  <span style=" display:inline"> </span>

  <label>@Resources.Resource.lblUserName :</label>
  <input type="text" id="txtUserName" class="form-control validationcontrols"     style=" width:90% !important;display:inline   " required="required"/>
   <span style=" display:inline"> </span>

    <label>@Resources.Resource.lblPassword :</label>
  <input type="password" id="txtPassword" class="form-control validationcontrols"  style=" width:90% !important;display:inline  " required="required"/>
     <span style=" display:inline"> </span>

        <label>@Resources.Resource.lblConfirmPassword:</label>
  <input type="password" id="txtConfirmPassword" class="form-control validationcontrols"    style=" width:90% !important; display:inline !important" required="required"/>
 
 
  <label>@Resources.Resource.lblDistributorCode:</label>
   @Html.DropDownList("ddlDistributorCode", ViewData["DCodes"] as List<SelectListItem>, new { @class = " form-control      InputElements chosenddl",   id = "ddlDistributerCode" ,style=" height: 33px !important;width:90%"})
    
 
   <label>@Resources.Resource.lblEmailId:</label> <span style=" display:inline;font-style:italic" id="spnEmail"> </span></span>
<br />
 <input type="text" id="txtEmail" class="form-control validationcontrols"    style=" width:90% !important; display:inline !important" required="required"/> 
  <div class="buttons"  style="padding-top: 20px;  "> 
  <button class="btn btn-small " id="btnRegister" >@Resources.Resource.btnRegister</button>
  <button class="btn btn-small " id="btnClear"> @Resources.Resource.btnClear</button>
   <br>   <br>
 

   </div>
 
 <div class="HiddenDiv" style="display:none"> 
 </div>  
  <span id="spnMsg" style=" display:inline-flex !important">   </span>
  </div>  
  </div>     
  <div class="col-lg-1 col-md-1  "></div>
   <div class=" col-lg-1     headerDivider hidden-xs hidden-md  hidden-sm" style="  height:418px !important;"></div>

    <div  class="col-lg-6    col-md-7 col-sm-10 col-xs-10  marginMD zeroMarginOnSmall"  style="padding: 18px 0px 0px 67px ! important;"  >
   <img   src="@Url.Content("~/images/banner01.png")"   style="width: 100%;" alt=""> 
  </div> 
  
  </div>

  </div>
</div> 
 
</div>
<div id="myModal" class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
       
    </div>
  </div>
</div>
   <br />  <br />
     <br />
      <br />   
     <script>

         if (typeof String.prototype.trim !== 'function') {
             String.prototype.trim = function () {
                 return this.replace(/^\s+|\s+$/g, '');
             }
         }
 
 
 </script>
 <script> 
  $("#txtUserID").on("paste", function (event) {  var element = this;setTimeout(function () { var text = $(element).val(); if (text.length >= 10) {$(element).val(text.substr(0, 10));} }, 100); });  
 $("#txtUserName").on("paste", function (event) {  var element = this;setTimeout(function () { var text = $(element).val(); if (text.length >= 20) {$(element).val(text.substr(0, 20));} }, 100); });  
  $("#txtPassword").on("paste", function (event) {  var element = this;setTimeout(function () { var text = $(element).val(); if (text.length >= 15) {$(element).val(text.substr(0, 20));} }, 100); });  
 $("#txtConfirmPassword").on("paste", function (event) {  var element = this;setTimeout(function () { var text = $(element).val(); if (text.length >= 15) {$(element).val(text.substr(0, 20));} }, 100); });  
 $('#txtEmail').keypress(function (event) {var key = event.which;if (this.value.length >= 50 && key != 8 && key != 13) { return false; } });

 $('#txtUserID').keypress(function (event) {var key = event.which;if (this.value.length >= 10 && key != 8 && key != 13) { return false; } });
 $('#txtUserName').keypress(function (event) {var key = event.which;if (this.value.length >= 20 && key != 8 && key != 13) { return false; } });
 $('#txtPassword').keypress(function (event) {var key = event.which;if (this.value.length >= 15 && key != 8 && key != 13) { return false; } });
$('#txtConfirmPassword').keypress(function (event) {var key = event.which;if (this.value.length >= 15 && key != 8 && key != 13) { return false; } });
$('#txtEmail').keypress(function (event) {var key = event.which;if (this.value.length >= 50 && key != 8 && key != 13) { return false; } });

 $(document).on("click",function () {

      $("#spnMsg").html("");
});

 

 $("#btnClear").on("click", function () {
 $(".validationcontrols").each(function () {
    
    $(this).val("");
})
 $("#spnMsg").html("")
 
 });


  $("#btnRegister").on("click", function () {
  
         if (!RegisterValidate()) {
             return;
         }

      ///   alert($.trim($("#ddlDbs").text()));
            var creds = {UserID: $.trim($("#txtUserID").val()), UserName: $.trim($("#txtUserName").val()), Password: $.trim($("#txtPassword").val()), CustomerCode: $.trim($("#ddlDistributerCode").val()) , Email: $.trim($("#txtEmail").val())}
     
         $.ajax(
                {
                cache: false,
                type: "POST",
                url: "@Url.Action("NewSiteUser", "User", null)",
                data: creds,
                success: onLoginFormSuccess,
                error: function (xhr, ajaxOptions, thrownError) {
                txtError = "An Error Occured While Registeration.Please Contact Administrator";
                txtErrorType = "0";
                DisplayModal(txtErrorType, txtError);
                         
                    }
                }); // ajax end 
     }); ///btnClick End
 </script>
    <script>
  

//  $("#txtDBCode").on("change",function(){
//  if($(this).val().trim()!="")
//  {
//  var postData={strDBCode:$("#txtDBCode").val().trim()};
//  
//  $.post("@Url.Action("CustomerCode_Change", "User", null)",postData,function(result){
//  

//  $(".HiddenDiv").html(result);


//  });  
//  }  
//  });

 function RegisterValidate() 

 {   
  var count=0;

 $(".validationcontrols").each(function () {
 
   if ($.trim($(this).val())=="") 
   {   
    $(this).addClass("validationCSS");    
     count+=1;
    }
    
    else
    {
    $(this).removeClass("validationCSS");
    if($(this).attr("id")=="txtEmail")
    {
         if (!isValidEmailAddress($.trim($(this).val()))) 
         {

           $("#spnEmail").html("Invalid Email Address").attr("style", "color:red;font-style:italic"); count+=1;
            $(this).addClass("validationCSS");   
         }else{ $("#spnEmail").html(""); $(this).removeClass("validationCSS");;}
    
    
    }
    


   else  if($(this).attr("id")=="txtPassword")
    {   
    
             if( $(this).attr("data-valid")!="" && $(this).attr("data-valid")== "false")
             {
                 $("#txtPassword").next("span").html("Passwords Do not Match!").attr("style", "color:red; position: absolute; width: 100%; top: 175px; left: 214px; font-style: italic;");
                 count+=1;
             }
           else 
           {
           $("#txtPassword").next("span").html("");
           $("#txtPassword").removeAttr("data-valid" );
           }
  }


    else
    { 
    $(this).next("span").html("");
    
    }  
    
    }

});

 if (!MatchPassword()) { count+=1;}

    if (count>0) 
    {
    return  false;

    }
    else 
    {
    return true;
    } 
   
 }

     function onLoginFormSuccess(data) {
     if (CheckForSessionExpiry(data)) {
			SessionExpiredRedirect();
		}
         if (data == "true") {
            // window.location.href = "@Url.Action("index", "Home", null)";
         }
         else if (data == "false")
         {
        // $(".modal-content").html("@Resources.Resource.InvalidCredentials").css("color", "red");

               //  $('#myModal').modal( );
          $("#spnMsg").html("@Resources.Resource.InvalidCredentials").attr("style", "color:red;position: absolute;") ;
  
   
         }else
         {
          $("#spnMsg").html(data).css("color", "red");
         
         }
     }
 
    </script>
 
 <script>
     function MatchPassword() {
         if ($.trim($("#txtConfirmPassword").val()) != $.trim($("#txtPassword").val())) {
             $("#txtPassword").next("span").html("Passwords Do not Match!").attr("style", "color:red; position: absolute; width: 100%; top: 175px; left: 214px; font-style: italic;");
             $("#txtPassword").attr("data-valid", "false")
             return false;
         } else { $("#txtPassword").removeAttr("data-valid"); return true; }

     }
 
 </script>
   <script>
       var txtErrorType;
       var txtError;
       $(document).keypress(function (e) {
           if (e.which == 13) {
               $("#btnLogin").trigger("click");
           }
       });

       $(document).ready(function () {
           $(".panel").parent("div").prepend("<div id='divLoading'></div>");

           $("#txtConfirmPassword").on("change", function () {
               MatchPassword();
           });


           $("#txtConfirmPassword").on("keyup", function () {
               if ($(this).length > 0) {
                   $(this).next("span").html("");

               }

           });

           $("#txtUserName").on("change", function () {
               if ($(this).length > 0) {
                   $(this).next("span").html("");
               }

           });


           $("#txtPassword").on("change", function () {
               if ($(this).length > 0) {
                   $(this).next("span").html("");
               }

           });

           $("#txtUserID").on("keyup", function () {
               $("#spnMsg").html("");
           });
           $("#txtPassword").on("keyup", function () {
               $("#spnMsg").html("");
           });
           $("#txtConfirmPassword").on("keyup", function () {
               if ($(this).length > 0) {
                   $(this).next("span").html("");
               }

           });

           $("#txtDBCode").on("keyup", function () {
               if ($(this).length > 0) {
                   $(this).next("span").html("");
               }

           });


           $("#txtEmail").on("keyup", function () {
               if ($(this).length > 0) {
                   $(this).next("span").html("");

               }

           });


       });  
   </script>
   <script>
       function isValidEmailAddress(emailAddress) {
           var pattern = new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);
           return pattern.test(emailAddress);

       };
       $(document).ajaxStart(function () {

           $("div#divLoading").addClass('show');

       });
       $(document).ajaxStop(function () {
           $("div#divLoading").removeClass('show');
       });

       $(document).ajaxError(function () {
           $("div#divLoading").removeClass('show');
       });
   </script>
   

  